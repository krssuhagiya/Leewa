<!DOCTYPE html>
<html lang="en">
<%-include('partials/head')%>
<body class="px-6 sm:px-16 tracking-wide bg-[#FAF8F0] text-[#1e1e19] font-[Montserrat]">
    <%-include('partials/topbar')%>
    <%-include('partials/navbar')%>

    <!-- Women's Section -->
    <h2 class="text-2xl font-semibold tracking-wide text-gray-800 text-center mt-28">
        Grace in Every Thread
    </h2>

    <div id="product-container" class="main my-16 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        <% let womenProducts = [
             { img: 'women1.jpg', title: 'ARIA SKIRT SET - BLUSH', price: '20,000' },
    { img: 'women2.jpg', title: 'Sahasra Gota Patti Silk Sharara Set - Black', price: '19,500' },
    { img: 'women3.jpg', title: 'Sawsan Embroidered Mul Tabard Set - White', price: '18,900' },
    { img: 'women4.jpg', title: 'Rowan Printed Kaftan - Sage', price: '17,500' },
    { img: 'women5.jpg', title: 'Moonlight Bloom Printed Silk Skirt Set - Blue', price: '16,800' },
    { img: 'women6.jpg', title: 'Silaam Printed Kaftan - Powder Blue', price: '16,500' },
    { img: 'women7.jpg', title: 'Elara Embroidered Silk Kurta Set - Ruby Red', price: '15,900' },
    { img: 'women8.jpg', title: 'Zara Handwoven Chanderi Saree - Gold', price: '15,500' },
    { img: 'women9.jpg', title: 'Aisha Floral Embroidered Gown - Lilac', price: '15,000' },
    { img: 'women10.jpg', title: 'Hanaa Sequined Anarkali Set - Emerald', price: '14,500' },
    { img: 'women11.jpg', title: 'Seraphina Draped Saree Set - Blush Pink', price: '14,000' },
    { img: 'women12.jpg', title: 'Mehira Organza Lehenga Set - Ivory', price: '13,800' },
    { img: 'women13.jpg', title: 'Leora Layered Georgette Skirt Set - Champagne', price: '13,500' },
    { img: 'women14.jpg', title: 'Fariha Embroidered Anarkali Set - Sapphire', price: '12,900' },
    { img: 'women15.jpg', title: 'Isla Chiffon Printed Maxi Dress - Coral', price: '12,500' },
    { img: 'women16.jpg', title: 'Zayna Banarasi Silk Lehenga - Maroon', price: '12,000' },
    { img: 'women17.jpg', title: 'Kiara Pastel Floral Lehenga Set - Peach', price: '11,500' },
    { img: 'women18.jpg', title: 'Samira Mirror Work Kurta Set - Beige', price: '11,000' },
    { img: 'women19.jpg', title: 'Rivana Draped Silk Saree - Teal', price: '10,800' },
    { img: 'women20.jpg', title: 'Noor Hand-Embroidered Sharara Set - Olive', price: '10,500' },
    { img: 'women21.jpg', title: 'Celine Sequined Gown - Midnight Blue', price: '10,000' },
    { img: 'women22.jpg', title: 'Aarya Georgette Anarkali Suit - Rose Gold', price: '9,500' },
    { img: 'women23.jpg', title: 'Liana Brocade Saree Set - Plum', price: '9,000' }, 
        ]; %>

        <% womenProducts.forEach(product => { %>
        <div class="card w-full p-4 shadow-md hover:shadow-lg transition duration-300">

            <div class="img h-[67vh] w-full overflow-hidden bg-gray-200">
                <img src="./img/<%= product.img %>" alt="" class="w-full h-full object-cover transition-transform duration-300 hover:scale-105">
            </div>
            <div class="tag flex items-center justify-between px-1 mt-2">
                <h5 class="text-[0.6rem] font-[600]">Client Name</h5>
                <i class="ri-heart-2-line text-xl cursor-pointer hover:text-red-500"></i>
            </div>
            <h4 class="tracking-widest font-[400] my-0.5 text-base"><%= product.title %></h4>
            <p class="font-light tracking-widest mt-2 mb-1">&#8377;<span><%= product.price %></span></p>
            <a href="#" id="addToCart" class="text-[0.6rem] font-bold border border-black py-1.5 px-2.5 inline-block mt-2 hover:bg-black hover:text-white transition">ADD TO CART</a>
        </div>
        <% }); %>
    </div>

    <%-include('partials/appointment')%>
    <%-include('partials/footer')%>
    <script>
      async function fetchProducts() {
          try {
              const responseP = await fetch("/get-product");
              const dataP = await responseP.json();
              const womenProducts = dataP.filter(product => product.gender === "Women");
  
              const productContainer = document.getElementById("product-container");
              productContainer.innerHTML = ""; // Clear previous data
  
              womenProducts.forEach(product => {
                  const productCard = `
                      <div class="card w-full p-4 shadow-md hover:shadow-lg transition duration-300">
                          <div class="img h-[67vh] w-full overflow-hidden bg-gray-200">
                              <img src="${product.image.replace(/\\/g, '/')}" alt="${product.productName}" class="w-full h-full object-cover transition-transform duration-300 hover:scale-105">
                          </div>
                          <div class="tag flex items-center justify-between px-1 mt-2">
                              <h5 class="text-[0.6rem] font-[600]">${product.clientName}</h5>
                              <i class="ri-heart-2-line text-xl cursor-pointer hover:text-red-500"></i>
                          </div>
                          <h4 class="tracking-widest font-[400] my-0.5 text-base">${product.productName}</h4>
                          <p class="font-light tracking-widest mt-2 mb-1">&#8377;<span>${product.price}</span></p>
                          <a href="#" class="addToCart text-[0.6rem] font-bold border border-black py-1.5 px-2.5 inline-block mt-2 hover:bg-black hover:text-white transition" data-id="${product._id}">
                              ADD TO CART
                          </a>
                      </div>
                  `;
  
                  productContainer.innerHTML += productCard;
              });
  
              // Attach event listeners after elements are added
              document.querySelectorAll(".addToCart").forEach(button => {
                  button.addEventListener("click", function (event) {
                      event.preventDefault();
                      const productId = this.getAttribute("data-id");
                      addToCart(productId);
                  });
              });
  
          } catch (error) {
              console.error("Error fetching products:", error);
          }
      }
  
      async function addToCart(productId) {
          try {
              const response = await fetch("/add-to-cart", {
                  method: "POST",
                  headers: {
                      "Content-Type": "application/json"
                  },
                  body: JSON.stringify({ productId })
              });
  
              const data = await response.json();
              if (response.ok) {
                  alert(data.message); // Show success message
              } else {
                  alert(data.error); // Show error message
              }
          } catch (error) {
              console.error("Error adding to cart:", error);
          }
      }
  
      fetchProducts(); // Call function to load products
  </script>
  
    <script src="/js/script.js"></script>
</body>
</html>
